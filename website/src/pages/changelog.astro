---
import Base from '../layouts/Base.astro';
import { url } from '../config';
---

<Base title="Changelog" description="Release history and version notes for Flux AIO.">
  <div class="container">
    <div class="breadcrumb">
      <a href={url('/')}>Home</a> / <a href={url('/changelog')}>Changelog</a>
    </div>

    <section class="section">
      <h1>Changelog</h1>
      <p class="section-sub">Release history and version notes.</p>
    </section>

    <section class="section changelog-entry">
      <h2>v1.6.3 <span class="changelog-date">2026</span></h2>
      <span class="changelog-tag tag-patch">Patch</span>

      <h3>Dashboard Polish (All Classes)</h3>
      <ul class="features">
        <li><strong>Section Separators</strong> &mdash; Subtle divider lines between Cooldowns, Buffs, and Debuffs sections for clearer visual grouping</li>
        <li><strong>Buff Active Borders</strong> &mdash; Active buffs now show a gold border; inactive buffs use a dim border</li>
        <li><strong>Threat Bar</strong> &mdash; Threat percentage is now a color-coded progress bar (green/orange/red) below the target info instead of inline text</li>
        <li><strong>Combo Point Pips</strong> &mdash; Visual combo point indicators for Druid (Cat) and Rogue, replacing the old text display</li>
        <li><strong>Icon Text Shadow</strong> &mdash; Drop shadow on icon overlay text for improved readability</li>
        <li><strong>Collapsible Debuffs</strong> &mdash; Debuff section hides automatically when no target exists and all tracked debuffs are target-based</li>
        <li><strong>Dimmer Idle States</strong> &mdash; &ldquo;Idle&rdquo; and &ldquo;N/A&rdquo; text uses a subtler color to reduce visual noise</li>
      </ul>

      <h3>Bug Fixes</h3>
      <ul class="features">
        <li><strong>Timer Bar Overflow</strong> &mdash; Fixed GCD and Swing timer bars extending outside the dashboard frame when resetting</li>
        <li><strong>Range Infinity Crash</strong> &mdash; Fixed integer overflow when <code>GetRange()</code> returns infinity</li>
      </ul>
    </section>

    <section class="section changelog-entry">
      <h2>v1.6.2 <span class="changelog-date">2026</span></h2>
      <span class="changelog-tag tag-patch">Patch</span>

      <h3>Bug Fixes (All Classes)</h3>
      <ul class="features">
        <li><strong>Trinkets Not Firing</strong> &mdash; Fixed trinket middleware passing invalid texture arguments to Show(), preventing offensive and defensive trinkets from activating</li>
      </ul>
    </section>

    <section class="section changelog-entry">
      <h2>v1.6.1 <span class="changelog-date">2026</span></h2>
      <span class="changelog-tag tag-patch">Patch</span>

      <h3>Bug Fixes (All Classes)</h3>
      <ul class="features">
        <li><strong>Position Persistence</strong> &mdash; Settings button and combat dashboard now correctly remember their dragged position across game reloads. Fixed a timing issue where the framework database wasn&rsquo;t ready when position restore ran</li>
        <li><strong>Range Detection</strong> &mdash; Simplified target range calculation in the shared context builder</li>
      </ul>
    </section>

    <section class="section changelog-entry">
      <h2>v1.6.0 <span class="changelog-date">2026</span></h2>
      <span class="changelog-tag tag-minor">Minor</span>

      <h3>New Features (All Classes)</h3>
      <ul class="features">
        <li><strong>Combat Dashboard</strong> &mdash; Real-time overlay showing current priority, cooldown readiness, buff/debuff tracking, resource bar, and GCD + swing/wand timer bars. Toggle via <code>/flux status</code> or the <em>Show Dashboard</em> setting</li>
        <li><strong><code>/flux</code> Slash Commands</strong> &mdash; <code>/flux burst</code> (force offensive CDs for 3s), <code>/flux def</code> (force defensive CDs for 3s), <code>/flux gap</code> (fire best gap closer), <code>/flux status</code> (toggle dashboard), <code>/flux help</code> (command list)</li>
        <li><strong>Burst Context System</strong> &mdash; Auto-burst conditions: during Bloodlust/Heroism, on pull (first 5s), in execute phase (&lt;20% HP), or always in combat. Configure per-class via checkboxes</li>
        <li><strong>Movable Settings Button</strong> &mdash; Settings button can now be dragged anywhere on screen instead of being locked to the minimap perimeter. Position persists across reloads</li>
        <li><strong>Dynamic Swing/Wand Timers</strong> &mdash; Dashboard timer bar automatically detects equipped weapon type: shows Swing for melee weapons, Wand/Shoot for ranged</li>
      </ul>

      <h3>Class-Specific Dashboard Configs</h3>
      <ul class="features">
        <li>Each class has tailored cooldown icons, buff/debuff tracking, and custom lines (e.g., Warrior stance display, Shaman totem states, Hunter pet HP, Rogue combo points)</li>
      </ul>
    </section>

    <section class="section changelog-entry">
      <h2>v1.4.0 <span class="changelog-date">2026</span></h2>
      <span class="changelog-tag tag-minor">Minor</span>

      <h3><a href={url('/classes/druid')} class="class-link c-druid">Druid</a></h3>
      <ul class="features">
        <li>Bear: Added tab targeting for threat management &mdash; cycles through nearby enemies to spread threat</li>
      </ul>

      <h3><a href={url('/classes/priest')} class="class-link c-priest">Priest</a></h3>
      <ul class="features">
        <li>Shadow: Fixed pre-combat pull sequence &mdash; Vampiric Touch before SW:P</li>
        <li>Shadow: Fixed debuff detection for SW:P and Vampiric Embrace</li>
        <li>Shadow: Added wand auto-attack as filler when no other spells available</li>
      </ul>
    </section>

    <section class="section changelog-entry">
      <h2>v1.3.1 <span class="changelog-date">2026</span></h2>
      <span class="changelog-tag tag-patch">Patch</span>

      <h3><a href={url('/classes/mage')} class="class-link c-mage">Mage</a></h3>
      <ul class="features">
        <li>Arcane: Trinkets and racial cooldowns now suppressed during conserve phase &mdash; they are held for the next burn window instead of wasted on low-value casts</li>
      </ul>

      <h3><a href={url('/classes/paladin')} class="class-link c-paladin">Paladin</a></h3>
      <ul class="features">
        <li>Retribution: Hammer of Wrath now skipped when mana is critically low (&le;1000) &mdash; rotation strips to Seal of Blood + Crusader Strike + Judgement only</li>
      </ul>
    </section>

    <section class="section changelog-entry">
      <h2>v1.3.0 <span class="changelog-date">2026</span></h2>
      <span class="changelog-tag tag-minor">Minor</span>

      <h3><a href={url('/classes/druid')} class="class-link c-druid">Druid</a></h3>
      <ul class="features">
        <li>Bear: Fixed Demoralizing Roar detection to use spell ID array &mdash; now correctly detects debuffs applied by other Druids</li>
        <li>Caster: Fixed nil guard on Innervate buff check; unified rejuv/regrowth checks with shared utilities</li>
      </ul>

      <h3><a href={url('/classes/mage')} class="class-link c-mage">Mage</a></h3>
      <ul class="features">
        <li>Arcane: Simplified burn/conserve cycle tracker &mdash; now uses <code>ab_stacks</code> natively, no separate counter; conserve&rarr;burn transition now allows &le;1 stack instead of requiring 0</li>
        <li>Arcane Filler now correctly checks <code>ab_stacks</code> at max before triggering (was broken with old counter)</li>
        <li>Remove Curse middleware now scans all party members, not just self</li>
      </ul>

      <h3><a href={url('/classes/paladin')} class="class-link c-paladin">Paladin</a></h3>
      <ul class="features">
        <li>Holy: Added configurable Divine Illumination mana threshold (default 60%)</li>
        <li>Holy/Protection: Added Racial strategies &mdash; Arcane Torrent (mana restore) and Stoneform (defensive), off-GCD</li>
        <li>Holy: Judgement only fires when no emergency targets exist (previously blocked when any target was below 80%)</li>
        <li>Protection: Added Mocking Blow &mdash; 2-min CD taunt fallback when in Battle Stance (smart filter: elites/bosses only, healer protection)</li>
        <li>Healing pool pre-allocated at load time &mdash; fixes potential in-combat table allocation</li>
      </ul>

      <h3><a href={url('/classes/priest')} class="class-link c-priest">Priest</a></h3>
      <ul class="features">
        <li>Discipline: Prayer of Healing minimum injured group count is now configurable (default 3, range 2&ndash;5)</li>
        <li>Holy: Renew/Greater Heal HP threshold now uses the <code>holy_renew_hp</code> setting instead of a hardcoded value</li>
      </ul>

      <h3><a href={url('/classes/rogue')} class="class-link c-rogue">Rogue</a></h3>
      <ul class="features">
        <li>Subtlety: Added Ghostly Strike strategy &mdash; secondary builder on cooldown, grants +15% dodge for 7s</li>
        <li>Subtlety: Preparation now only fires when Shadowstep is actually talented (not on every spec)</li>
        <li>Assassination/Subtlety: Rupture refresh window is now configurable (default 2s)</li>
        <li>Shiv now bypasses the energy pooling gate &mdash; Deadly Poison refresh takes priority even while pooling for the next finisher</li>
      </ul>

      <h3><a href={url('/classes/shaman')} class="class-link c-shaman">Shaman</a></h3>
      <ul class="features">
        <li>Enhancement: Moved Windfury and Fire Nova Totem twists before Stormstrike/Shock &mdash; time-sensitive totem management now fires correctly</li>
        <li>Restoration: Earth Shield now checks <code>is_spell_available</code> (only fires when 41pt Restoration talent is learned)</li>
      </ul>

      <h3><a href={url('/classes/warlock')} class="class-link c-warlock">Warlock</a></h3>
      <ul class="features">
        <li>Life Tap fallback strategy now mirrors the <code>life_tap_mana_pct</code> middleware threshold &mdash; no longer fires at 90% mana as a last resort</li>
      </ul>

      <h3><a href={url('/classes/warrior')} class="class-link c-warrior">Warrior</a></h3>
      <ul class="features">
        <li>Arms: Overpower moved before Mortal Strike &mdash; dodge proc window (5s) now correctly prioritized</li>
        <li>Protection: Added Mocking Blow &mdash; 2-min CD taunt fallback for Battle Stance (smart filter: elites/bosses, healer protection)</li>
        <li>Added configurable Bloodrage minimum HP setting (default 50%; Bloodrage costs HP)</li>
        <li>Added Berserker Rage toggle &mdash; was previously always firing when in Berserker Stance with no setting check</li>
        <li>Arms/Fury/Protection: Settings checks migrated to <code>setting_key</code> auto-check pattern (cleaner, no duplicate logic)</li>
      </ul>
    </section>

    <section class="section changelog-entry">
      <h2>v1.2.6 <span class="changelog-date">2026</span></h2>
      <span class="changelog-tag tag-patch">Patch</span>

      <h3><a href={url('/classes/druid')} class="class-link c-druid">Druid</a></h3>
      <ul class="features">
        <li>Lowered default Bear Mangle rage threshold from 20 to 15 (minimum spell cost)</li>
      </ul>
    </section>

    <section class="section changelog-entry">
      <h2>v1.2.5 <span class="changelog-date">2026</span></h2>
      <span class="changelog-tag tag-patch">Patch</span>

      <h3><a href={url('/classes/druid')} class="class-link c-druid">Druid</a></h3>
      <ul class="features">
        <li>Fixed melee range fallback using Wrath (30yd) in caster form &mdash; now only applies to Cat and Bear forms</li>
      </ul>
    </section>

    <section class="section changelog-entry">
      <h2>v1.2.4 <span class="changelog-date">2026</span></h2>
      <span class="changelog-tag tag-patch">Patch</span>

      <h3><a href={url('/classes/druid')} class="class-link c-druid">Druid</a></h3>
      <ul class="features">
        <li>Added fallback melee range detection using spell IsInRange (fixes nil GetRange for some users)</li>
      </ul>

      <h3><a href={url('/classes/mage')} class="class-link c-mage">Mage</a></h3>
      <ul class="features">
        <li>Added Freeze action for Water Elemental debuff tracking (fixes Frost nil error)</li>
        <li>Cold Snap now checks both Icy Veins and Water Elemental cooldowns</li>
        <li>Blast Wave and Dragon&rsquo;s Breath now require melee range</li>
        <li>Added Ice Barrier middleware with toggle setting</li>
      </ul>

      <h3><a href={url('/classes/paladin')} class="class-link c-paladin">Paladin</a></h3>
      <ul class="features">
        <li>Added Greater Blessing IDs to buff tracking (no longer overwrites 30-min blessings)</li>
        <li>Added Crusader Aura to aura detection</li>
        <li>Fixed enemy count range to 8yd (Consecration radius)</li>
        <li>Protection: Reordered priorities &mdash; Holy Shield and Seal before Avenger&rsquo;s Shield</li>
        <li>Protection: Smart taunt system &mdash; Righteous Defense now only fires on elites/bosses, skips CC&rsquo;d and dying mobs, prioritizes healer protection</li>
        <li>Added Disable Taunts (Off-Tank) master switch for Protection</li>
      </ul>

      <h3><a href={url('/classes/priest')} class="class-link c-priest">Priest</a></h3>
      <ul class="features">
        <li>Discipline: Added Emergency Flash Heal (highest priority), Trinket, and Racial strategies</li>
        <li>Discipline: Reordered priorities &mdash; Emergency FH before PW:S</li>
        <li>Holy: Added Inner Focus strategy (off-GCD before Greater Heal)</li>
        <li>Holy: Added Trinket and Racial strategies</li>
        <li>Fade now uses nameplate scanning with boss/elite/trash count thresholds</li>
        <li>Fixed healing.lua tank detection (UnitIsUnit API call)</li>
        <li>Shadow/Smite: Fixed Starshards and Devouring Plague to check IsReady</li>
        <li>Smite: Fixed Holy Fire to work with and without weave mode</li>
      </ul>

      <h3><a href={url('/classes/rogue')} class="class-link c-rogue">Rogue</a></h3>
      <ul class="features">
        <li>Added Expose Armor strategy to Assassination and Subtlety specs</li>
        <li>Fixed Racial strategies to check IsReady before matching (all 3 specs)</li>
        <li>Added pooling gate to Rupture (all specs) to prevent energy waste</li>
        <li>Added PlayerClass guards to all spec modules</li>
        <li>Removed unused feint_threat_pct schema setting</li>
        <li>Haste Potion no longer restricted to Blade Flurry/AR windows</li>
      </ul>

      <h3><a href={url('/classes/shaman')} class="class-link c-shaman">Shaman</a></h3>
      <ul class="features">
        <li>Fixed Earth Shock interrupt priority (now highest middleware priority)</li>
        <li>Restoration: Nature&rsquo;s Swiftness now correctly marked as off-GCD</li>
        <li>Elemental: Moved Fire Elemental to lower priority (after core rotation)</li>
        <li>Enhancement: Earth Shock now prioritized during Stormstrike +20% nature debuff</li>
        <li>Enhancement: Added AoE strategy (Fire Nova &gt; Magma &gt; Chain Lightning)</li>
      </ul>

      <h3><a href={url('/classes/warlock')} class="class-link c-warlock">Warlock</a></h3>
      <ul class="features">
        <li>Added useMaxRank to Incinerate, Unstable Affliction, and Shadowfury (fixes R1 casting)</li>
        <li>Removed duplicate IncinerateR2 action</li>
        <li>Affliction: Fixed Curse of Agony clipping (0.5s threshold preserves accelerating ticks)</li>
        <li>Affliction: Moved AoE higher in priority order</li>
        <li>Demonology: Added Fel Domination + pet resummon strategy</li>
        <li>Demonology: Added Soul Link maintenance strategy</li>
      </ul>

      <h3><a href={url('/classes/warrior')} class="class-link c-warrior">Warrior</a></h3>
      <ul class="features">
        <li>Arms: Fixed Sweeping Strikes to be on-GCD (TBC behavior)</li>
        <li>Arms/Fury: Added Thunder Clap and Demoralizing Shout maintenance strategies</li>
        <li>Fury: Rampage now always used when stacks &lt; 5 (builds to max before refresh-only mode)</li>
        <li>Protection: Smart taunt system &mdash; Taunt now only fires on elites/bosses, skips CC&rsquo;d and dying mobs, prioritizes healer protection</li>
        <li>Protection: Added Challenging Shout (AoE taunt) with configurable boss/elite/trash thresholds</li>
        <li>Added Disable Taunts (Off-Tank) master switch for Protection</li>
      </ul>
    </section>

    <section class="section changelog-entry">
      <h2>v1.2.2 <span class="changelog-date">2026</span></h2>
      <span class="changelog-tag tag-patch">Patch</span>

      <h3><a href={url('/classes/hunter')} class="class-link c-hunter">Hunter</a></h3>
      <ul class="features">
        <li>Removed Aimed Shot from rotation &mdash; should not be used in standard BM/SV rotations</li>
      </ul>

      <h3><a href={url('/classes/warrior')} class="class-link c-warrior">Warrior</a></h3>
      <ul class="features">
        <li>Arms: Moved Overpower to correct priority (after Sunder Armor maintain, before Slam)</li>
        <li>Fury: Added Overpower minimum rage setting</li>
      </ul>

      <h3><a href={url('/classes/mage')} class="class-link c-mage">Mage</a></h3>
      <ul class="features">
        <li>Arcane: Added Fireball as filler option</li>
        <li>Frost: Fixed frozen target detection to include Water Elemental Freeze</li>
      </ul>

      <h3><a href={url('/classes/paladin')} class="class-link c-paladin">Paladin</a></h3>
      <ul class="features">
        <li>Protection: Moved Avenger&rsquo;s Shield to highest priority for pull/interrupt</li>
        <li>Protection: Righteous Defense now properly respects its toggle setting</li>
      </ul>

      <h3><a href={url('/classes/shaman')} class="class-link c-shaman">Shaman</a></h3>
      <ul class="features">
        <li>Enhancement: Moved Shock priority above Windfury Twist to avoid clipping</li>
        <li>Elemental: Moved Fire Elemental to higher priority</li>
        <li>Elemental: Fixed Chain Lightning clearcast threshold &mdash; now requires fresh 2-charge proc</li>
      </ul>

      <h3><a href={url('/classes/warlock')} class="class-link c-warlock">Warlock</a></h3>
      <ul class="features">
        <li>Fixed Life Tap priority &mdash; now correctly fires after Mana Potion and Dark Rune</li>
      </ul>

      <h3><a href={url('/classes/priest')} class="class-link c-priest">Priest</a></h3>
      <ul class="features">
        <li>Holy: Moved Renew spread before Greater Heal/Flash Heal (instant HoT before cast-time heals)</li>
      </ul>

      <h3><a href={url('/classes/rogue')} class="class-link c-rogue">Rogue</a></h3>
      <ul class="features">
        <li>Feint now checks threat before firing (no longer wastes energy when not tanking)</li>
        <li>Haste Potion now usable on pull for non-Combat specs</li>
      </ul>
    </section>

    <section class="section changelog-entry">
      <h2>v1.2.1 <span class="changelog-date">2026</span></h2>
      <span class="changelog-tag tag-patch">Patch</span>

      <h3><a href={url('/classes/warrior')} class="class-link c-warrior">Warrior</a></h3>
      <ul class="features">
        <li>Fixed Fury Rampage refresh logic &mdash; removed redundant stack check, now only refreshes when duration is low (stacks build naturally via refreshes)</li>
      </ul>
    </section>

    <section class="section changelog-entry">
      <h2>v1.2.0 <span class="changelog-date">2026</span></h2>
      <span class="changelog-tag tag-major">Major Release</span>

      <h3>6 New Classes</h3>
      <ul class="features">
        <li>Added <a href={url('/classes/paladin')} class="class-link c-paladin">Paladin</a> &mdash; Retribution (seal twisting), Protection (Holy Shield uptime), and Holy (smart party healing)</li>
        <li>Added <a href={url('/classes/priest')} class="class-link c-priest">Priest</a> &mdash; Shadow (DoT management), Smite (Holy Fire weaving), Holy (reactive healing), and Discipline (PW:S prevention)</li>
        <li>Added <a href={url('/classes/rogue')} class="class-link c-rogue">Rogue</a> &mdash; Combat (Blade Flurry/AR), Assassination (Mutilate/Envenom), and Subtlety (Shadowstep burst)</li>
        <li>Added <a href={url('/classes/shaman')} class="class-link c-shaman">Shaman</a> &mdash; Elemental (CL modes), Enhancement (totem twisting), and Restoration (Earth Shield healing)</li>
        <li>Added <a href={url('/classes/warlock')} class="class-link c-warlock">Warlock</a> &mdash; Affliction (full DoT stack), Demonology (Felguard/DS:Ruin), and Destruction (Conflagrate cycle)</li>
        <li>Added <a href={url('/classes/warrior')} class="class-link c-warrior">Warrior</a> &mdash; Arms (MS/Rend), Fury (BT/Rampage), and Protection (Shield Slam/Revenge tanking)</li>
      </ul>

      <h3>All 9 classes now supported with full rotation logic, configurable settings, and spec-specific middleware.</h3>
    </section>

    <section class="section changelog-entry">
      <h2>v1.1.1 <span class="changelog-date">2026</span></h2>
      <span class="changelog-tag tag-patch">Patch</span>

      <h3>Settings UI</h3>
      <ul class="features">
        <li>Darkened background colors in the in-game settings panel for improved contrast and readability</li>
      </ul>
    </section>

    <section class="section changelog-entry">
      <h2>v1.1.0 <span class="changelog-date">2026</span></h2>
      <span class="changelog-tag tag-minor">Minor</span>

      <h3><a href={url('/classes/druid')} class="class-link c-druid">Druid</a></h3>
      <ul class="features">
        <li>Fixed Off-Tank mode tooltip &mdash; correctly states it disables Growl and Challenging Roar (Maul was never affected)</li>
      </ul>
    </section>

    <section class="section changelog-entry">
      <h2>v1.0.0 <span class="changelog-date">2025</span></h2>
      <span class="changelog-tag tag-major">Major Release</span>

      <h3>Multi-Class Architecture</h3>
      <ul class="features">
        <li>Rewritten as a multi-class AIO supporting <a href={url('/classes/druid')} class="class-link c-druid">Druid</a> and <a href={url('/classes/hunter')} class="class-link c-hunter">Hunter</a></li>
        <li>New strategy registry pattern &mdash; middleware (shared) + per-playstyle strategies</li>
        <li>Class registration system with automatic playstyle detection based on current form/stance</li>
        <li>Schema-driven settings &mdash; one schema generates the UI, framework backing store, and cached runtime access</li>
      </ul>

      <h3><a href={url('/classes/druid')} class="class-link c-druid">Druid</a></h3>
      <ul class="features">
        <li>5 playstyles: Cat DPS, Bear Tank, Balance Moonkin, Resto Tree, and Caster recovery</li>
        <li>Per-spell cat strategies with energy pooling, combo point tracking, and powershift support</li>
        <li>Wolfshead Helm detection for automatic powershift optimization</li>
        <li>Intelligent heal downranking based on HP deficit and mana efficiency</li>
        <li>Resto/Tree of Life healing with tank prioritization and emergency thresholds</li>
        <li>Balance mana tier system for sustainable Moonkin DPS</li>
        <li>Form-aware automation &mdash; rotation respects current form, suggestion icon recommends shifts</li>
      </ul>

      <h3><a href={url('/classes/hunter')} class="class-link c-hunter">Hunter</a></h3>
      <ul class="features">
        <li>Full ranged DPS rotation with auto-shot clip tracking</li>
        <li>Shot weaving: Steady Shot, Arcane Shot, Multi-Shot with proper clipping prevention</li>
        <li>Sting priority system (Serpent Sting management)</li>
        <li>Pet management with auto-call, health monitoring, and Mend Pet</li>
        <li>Mana-aware aspect switching between Hawk and Viper</li>
        <li>Cooldown management: Bestial Wrath, Rapid Fire, Readiness, Kill Command</li>
        <li>Optional debug overlay for auto-shot timing visualization</li>
      </ul>

      <h3>Infrastructure</h3>
      <ul class="features">
        <li>Monorepo restructure: rotation, website, and Discord bot as separate packages</li>
        <li>New Node.js build system &mdash; auto-discovers class modules, manages load order, compiles to single TMW profile</li>
        <li>File watcher (<code>dev-watch.js</code>) for auto-rebuild and SavedVariables sync during development</li>
        <li>Static website for documentation and distribution</li>
        <li>Discord bot for personalized rotation tweaks via AI</li>
      </ul>
    </section>

  </div>
</Base>
